{% extends 'layout.html' %}
{% block title %}Search{% endblock %}
{% block classdash %}<a class="nav-link" href="../home">{% endblock %}
  {% block classfind %}<a class="nav-link active" href="{{ url_for('matching.search') }}">{% endblock %}
  {% block classreq %}<a class="nav-link " href="{{ url_for('matching.pending') }}">{% endblock %}
  {% block classmat %}<a class="nav-link" href="{{ url_for('matching.matched') }}">{% endblock %}
  {% block classprof %}<a class="nav-link " href="{{ url_for('home.profile') }}">{% endblock %}
  {% block classmast %}<a class="nav-link " href="{{ url_for('master.show') }}">{% endblock %}
{% block pagename %}<li class="breadcrumb-item text-sm text-white active" aria-current="page">Find a Buddy</li>{% endblock %}
{% block pagename_large %} Find a Buddy {% endblock %}

{% block content %}
<div class="container-fluid py-4">
  <div class="row">
    <div class="col-md-12">
      <div class="card">
        <div class="card-header pb-0 pt-3 bg-transparent">
          <h6 class="text-capitalize">Find a Buddy</h6>
        </div>
        <form action="{{url_for('matching.search')}}" method="post">
        <div class="card-body">
          <span id="buddies"></span>
          <br>
          <div class="row mt-4">
            <div class="col-md-6 text-sm-right">
                  <button class="btn btn-primary btn-sm">Match</button>
                  <!--<input type="hidden" name="destnetid" value="{{ user.netid }}"></input>-->
        </form>
            </div>
            <div class="col-md-6 text-sm-left">
                <!--<form action="{{url_for('matching.search')}}" method="get">-->
                  <!-- Pass button -->
                  <button id="passButton" class="btn btn-primary btn-sm" type="button" >Pass</button>
            
                <!--</form>-->
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>  
</div>

{% endblock %}
{% block scripts %}
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
  <script>
      'use strict';

      function listBuddies(response)
      {
        $('#buddies').html(response);
      }
      let request = null;
      function getBuddies()
      {;
        let sessionindex = $('#indexInput').val();
        console.log(sessionindex)
        if (request != null)
          request.abort();
        request =$.ajax(
          {
            type: 'GET',
            data: {"index": sessionindex},
            url: '/matching/buddies',
            success: listBuddies
          }
        );
      }
      function setup()
      {
        getBuddies();
        $('#passButton').on('click', getBuddies);
      }
      $('document').ready(setup);
</script>
{% endblock %}
