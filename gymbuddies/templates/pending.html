{% extends 'layout.html' %} {% block title %}Incoming Requests{% endblock %} 
{% block classdash %}<a class="nav-link" href="../home">{% endblock %} 
  {% block classfind %}<a class="nav-link" href="{{ url_for('matching.search') }}">{% endblock %} 
  {% block classreq %}<a class="nav-link active" href="{{ url_for('matching.pending') }}">{% endblock %} 
  {% block classmat %}<a class="nav-link" href="{{ url_for('matching.matched') }}">{% endblock %} 
  {% block classprof %}<a class="nav-link" href="{{ url_for('home.profile') }}">{% endblock %} 
  {% block classmast %}<a class="nav-link" href="{{ url_for('master.show') }}">{% endblock %}
  {% block pagename %}<li class="breadcrumb-item text-sm text-white active" aria-current="page">Incoming Requests</li>
{% endblock %} 
{% block pagename_large %}Incoming Requests{%endblock %} 

{% block content %}
            <!-- <p>You have no requests at this time.</p>-->
            <div class="modal fade bd-example-modal-lg" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLongTitle" aria-hidden="true">
              <div class="modal-dialog modal-lg" role="document">
                <div class="modal-content">
                  <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLongTitle">{{ g.user.name }}</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                      <span aria-hidden="true">&times;</span>
                    </button>
                  </div>
                  <div class="modal-body">
                    <div class="card-body">
                      <div class="row">
                        <div class="col-md-6">
                          <!-- Person's Schedule -->
                          <div class="p-3">
                            {% include 'calendar.html' %}
                          </div>
                          
                        </div>
                        <div class="col-md-6">
                        <div class="card z-index-2 h-90">
                          <div class="card-header pb-0 pt-3 bg-transparent">
                              <h6 class="text-capitalize">Profile</h6>
                                <div class="card-body pt-2">
                                  <!--<span class="text-gradient text-primary text-uppercase text-xs font-weight-bold my-2"> testandie </span>-->
                                  <a href="javascript:;" class="card-title h5 d-block text-darker">
                                    {{ g.user.name }}
                                  </a>
                                  <p class="card-description mb-4">
                                    <br>
                                    Bio: {{ g.user.bio }}
                                  </p>
                                  <!--<p class="card-description mb-4">
                                    Contact:
                                  </p>-->
                                  <p class="card-description mb-4">
                                    Level: {{ level }}
                                  </p>
                                  <p class="card-description mb-4">
                                    Interests: {{ g.user.interests }}
                                  </p>
                                  <p class="card-description mb-4">
                                    Additional Information: {{ g.user.addinfo }}
                                  </p>
                                </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                    <!-- <button type="button" class="btn btn-primary">Save changes</button> -->
                  </div>
                </div>
              </div>
            </div>
            <!--  -->
            <div class="row">
              <div class="col-12 mb-4">
                <div class="card">
                  <div class="card-header pb-0 px-3">
                    <h6 class="mb-0">Pending</h6>
                  </div>
                  <div class="card-body pt-4 p-3">
                    <span id="requestTable"></span>
                  </div>
                </div>
              </div>
            </div>
{% endblock %}

{% block scripts %}
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
  <script>
      function listRequests(response)
      {
        $('#requestTable').html(response);
      }
      let request = null;

      function getRequests()
      {
        //let sessionindex = $('#indexInput').val();
        let requestid = $('#requestInput').val();
        let action = $('#acceptButton').val()
        console.log(requestid)
        console.log(action)
        
        if (request != null)
          request.abort();
        request =$.ajax(
          {
            type: 'POST',
            data: {"requestid": requestid, "action": action},
            url: '/matching/pendingtable',
            success: listRequests
          }
        );
      }
      function refreshRequests()
      {
        if (request != null)
          request.abort();
        request =$.ajax(
          {
            type: 'POST',
            //data: {"requestid": requestid, "action": action},
            url: '/matching/pendingtable',
            success: listRequests
          }
        );
      }
      function setup()
      {
        getRequests();
        //$('#deleteButton').on('click', getMatches);
        window.setInterval(refreshRequests, 1000);
      }
      $('document').ready(setup);
  </script>
{% endblock %}


